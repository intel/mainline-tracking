# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/dma/snps,dw-axi-dmac.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Synopsys DesignWare AXI DMA Controller

maintainers:
  - Eugeniy Paltsev <Eugeniy.Paltsev@synopsys.com
  - Sia, Jee Heng <jee.heng.sia@intel.com>

description: |
 Synopsys DesignWare AXI DMA Controller DT Binding

properties:
  compatible:
    enum:
      - snps,axi-dma-1.01a
      - intel,kmb-axi-dma

  reg:
    items:
      - description: Address range of the DMAC registers.

  reg-names:
    items:
      - const: axidma_ctrl_regs
      - const: axidma_apb_regs

  interrupts:
    maxItems: 1

  clocks:
    items:
      - description: Bus Clock
      - description: Module Clock

  clock-names:
    items:
      - const: core-clk
      - const: cfgr-clk

  '#dma-cells':
    const: 1

  dma-channels:
    description: |
      Number of channels supported by hardware.

  snps,dma-masters:
    description: |
      Number of AXI masters supported by the hardware.
    allOf:
      - $ref: /schemas/types.yaml#/definitions/uint32
      - enum: [1, 2]
        default: 2

  snps,data-width:
    description: |
      AXI data width supported by hardware.
      (0 - 8bits, 1 - 16bits, 2 - 32bits, ..., 6 - 512bits)
    allOf:
      - $ref: /schemas/types.yaml#/definitions/uint32
      - enum: [0, 1, 2, 3, 4, 5, 6]
        default: 4

  snps,priority:
    description: |
      Channel priority specifier associated with the DMA channels.
    allOf:
      - $ref: /schemas/types.yaml#/definitions/uint32-array
      - minItems: 1
        maxItems: 8
        default: [0, 1, 2, 3]

  snps,block-size:
    description: |
      Channel block size specifier associated with the DMA channels.
    allOf:
      - $ref: /schemas/types.yaml#/definitions/uint32-array
      - minItems: 1
        maxItems: 8
        default: [4096, 4096, 4096, 4096]

  snps,axi-max-burst-len:
    description: |
      Restrict master AXI burst length by value specified in this property.
      If this property is missing the maximum AXI burst length supported by
      DMAC is used. [1:256]
    allOf:
      - $ref: /schemas/types.yaml#/definitions/uint32
        default: 16

required:
  - compatible
  - reg
  - clocks
  - clock-names
  - interrupts
  - '#dma-cells'
  - dma-channels
  - snps,dma-masters
  - snps,data-width
  - snps,priority
  - snps,block-size

examples:
  - |
     #include <dt-bindings/interrupt-controller/arm-gic.h>
     #include <dt-bindings/interrupt-controller/irq.h>
     /* example with snps,dw-axi-dmac */
     dmac: dma-controller@80000 {
         compatible = "snps,axi-dma-1.01a";
         reg = <0x80000 0x400>;
         clocks = <&core_clk>, <&cfgr_clk>;
         clock-names = "core-clk", "cfgr-clk";
         interrupt-parent = <&intc>;
         interrupts = <27>;
         #dma-cells = <1>;
         dma-channels = <4>;
         snps,dma-masters = <2>;
         snps,data-width = <3>;
         snps,block-size = <4096 4096 4096 4096>;
         snps,priority = <0 1 2 3>;
         snps,axi-max-burst-len = <16>;
     };

  - |
     #include <dt-bindings/interrupt-controller/arm-gic.h>
     #include <dt-bindings/interrupt-controller/irq.h>
     /* example with intel,kmb-axi-dma */
     #define KEEM_BAY_PSS_AXI_DMA
     #define KEEM_BAY_PSS_APB_AXI_DMA
     axi_dma: dma@28000000 {
         compatible = "intel,kmb-axi-dma";
         reg = <0x28000000 0x1000 0x20250000 0x24>;
         reg-names = "axidma_ctrl_regs", "axidma_apb_regs";
         interrupts = <GIC_SPI 88 IRQ_TYPE_LEVEL_HIGH>;
         clock-names = "core-clk", "cfgr-clk";
         clocks = <&scmi_clk KEEM_BAY_PSS_AXI_DMA>, <&scmi_clk KEEM_BAY_PSS_APB_AXI_DMA>;
         #dma-cells = <1>;
         dma-channels = <8>;
         snps,dma-masters = <1>;
         snps,data-width = <4>;
         snps,priority = <0 0 0 0 0 0 0 0>;
         snps,block-size = <1024 1024 1024 1024 1024 1024 1024 1024>;
         snps,axi-max-burst-len = <16>;
     };
